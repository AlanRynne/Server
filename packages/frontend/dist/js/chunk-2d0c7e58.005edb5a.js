(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c7e58"],{5326:function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return e.hasLocalStrategy?t("v-container",{attrs:{fluid:""}},[t("v-form",{ref:"form"},[t("v-row",{staticStyle:{"margin-top":"-10px"},attrs:{dense:""}},[t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{label:"your email",rules:e.validation.emailRules,solo:""},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{staticStyle:{"margin-top":"-12px"},attrs:{label:"password",type:"password",rules:e.validation.passwordRules,solo:""},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}}),t("v-btn",{staticStyle:{top:"-22px"},attrs:{block:"",large:"",color:"accent"},on:{click:e.loginUser}},[e._v("Log in")]),t("p",{staticClass:"text-center"},[t("v-btn",{attrs:{text:"",small:"",block:"",color:"accent",to:{name:"Register",query:{appId:e.$route.query.appId}}}},[e._v("Create Account")])],1)],1)],1)],1),t("v-snackbar",{attrs:{"multi-line":""},model:{value:e.registrationError,callback:function(r){e.registrationError=r},expression:"registrationError"}},[e._v(" "+e._s(e.errorMessage)+" "),t("v-btn",{attrs:{color:"red",text:""},on:{click:function(r){e.registrationError=!1}}},[e._v(" Close ")])],1)],1):e._e()},o=[],n=(t("99af"),t("c740"),t("d3b7"),t("ac1f"),t("3ca3"),t("841c"),t("ddb0"),t("2b3d"),t("96cf"),t("1da1")),l=t("8785"),s=t("9530"),i=t.n(s),c=(t("ca94"),t("f7fe"),t("4556")),u=t.n(c);function d(){var e=Object(l["a"])([" query { serverInfo { name company adminContact termsOfService scopes { name description } authStrategies { id name color icon url } } }  "]);return d=function(){return e},e}var p={name:"Login",apollo:{serverInfo:{query:i()(d())}},computed:{hasLocalStrategy:function(){return-1!==this.serverInfo.authStrategies.findIndex((function(e){return"local"===e.id}))}},methods:{loginUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,t=e.$refs.form.validate(),t){r.next=4;break}throw new Error("Form validation failed");case 4:return r.next=6,fetch("/auth/local/login?appId=".concat(e.appId,"&challenge=").concat(e.challenge),{method:"POST",headers:{"Content-Type":"application/json"},redirect:"follow",body:JSON.stringify({email:e.form.email,password:e.form.password})});case 6:if(a=r.sent,console.log(a),a.redirected&&(window.location=a.url),a.ok){r.next=11;break}throw new Error("Login failed");case 11:r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),e.errorMessage=r.t0.message,e.registrationError=!0;case 17:case"end":return r.stop()}}),r,null,[[0,13]])})))()}},data:function(){return{serverInfo:{authStrategies:[]},form:{email:null,password:null},validation:{passwordRules:[function(e){return!!e||"Required"}],emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+\..+/.test(e)||"E-mail must be valid"}]},registrationError:!1,errorMessage:"",appId:null,serverApp:null}},mounted:function(){var e=new URLSearchParams(window.location.search),r=e.get("appId"),t=e.get("challenge");this.appId=r||"spklwebapp",t||"spklwebapp"!==this.appId?t&&(this.challenge=t):(this.challenge=u()({length:10}),localStorage.setItem("appChallenge",this.challenge))}},f=p,m=t("2877"),g=t("6544"),v=t.n(g),h=t("8336"),w=t("62ad"),b=t("a523"),k=t("4bd4"),x=t("0fd9"),y=t("2db4"),I=t("8654"),S=Object(m["a"])(f,a,o,!1,null,null,null);r["default"]=S.exports;v()(S,{VBtn:h["a"],VCol:w["a"],VContainer:b["a"],VForm:k["a"],VRow:x["a"],VSnackbar:y["a"],VTextField:I["a"]})}}]);
//# sourceMappingURL=chunk-2d0c7e58.005edb5a.js.map